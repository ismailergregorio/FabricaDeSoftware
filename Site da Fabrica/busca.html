<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resultados da Busca - Fábrica de Software</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
   <style>
    #suggestions {
      position: absolute;
      background: white;
      z-index: 10;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
  </style>

</head>
<body>
   <!-- Botão Voltar -->
  <div class="container my-3">
    <a href="index.html" class="btn btn-secondary">&larr; Voltar</a>
  </div>

  <!-- Barra de Pesquisa -->
  <div class="container my-4">
    <div class="position-relative mb-4">
      <div class="d-flex">
        <input
          id="search-input"
          type="text"
          placeholder="Pesquisar projetos..."
          class="form-control me-2"
        />
        <button id="search-button" class="btn btn-primary">Buscar</button>
      </div>
      <div id="suggestions" class="hidden"></div>
    </div>
  </div>

  <div class="container mt-5">
    <h1 class="mb-4">Resultados da Busca</h1>
    <div id="resultados" class="mt-4"></div>
  </div>

  <!-- Importa busca.js -->
  <script type="module">
    import { inicializarBusca } from "./js/busca.js";

    document.addEventListener("DOMContentLoaded", () => {
      // Inicializa o autocomplete na página de resultados também
      inicializarBusca("search-input", "suggestions");

      const params = new URLSearchParams(window.location.search);
      const termo = params.get("q");

      if (!termo) return;

      fetch("http://localhost:8080/projetos/getprojetos")
        .then(res => res.json())
        .then(projetos => {
          const resultados = projetos.filter(p =>
            p.nomeDoProjeto.toLowerCase().includes(termo.toLowerCase())
          );

          const container = document.getElementById("resultados");
          container.innerHTML = "";

          if (resultados.length > 0) {
            resultados.forEach(projeto => {
              const card = document.createElement("div");
              card.className = "card mb-3";
              card.innerHTML = `
                <div class="row g-0">
                  <div class="col-md-4">
                    <img src="${projeto.linkImage}" class="img-fluid rounded-start" alt="${projeto.nomeDoProjeto}">
                  </div>
                  <div class="col-md-8">
                    <div class="card-body">
                      <h5 class="card-title">${projeto.nomeDoProjeto}</h5>
                      <p class="card-text">${projeto.descricaoDoProjeto}</p>
                      ${projeto.linkGit ? `<a href="${projeto.linkGit}" target="_blank" class="btn btn-primary">Repositório GitHub</a>` : ""}
                    </div>
                  </div>
                </div>
              `;
              container.appendChild(card);
            });
          } else {
            container.innerHTML = `<p class="text-muted">Nenhum resultado encontrado para <strong>${termo}</strong>.</p>`;
          }
        })
        .catch(err => console.error("Erro ao buscar projetos:", err));
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(window.location.search);
      const termo = params.get("q");

      if (!termo) return;

      fetch("http://localhost:8080/projetos/getprojetos")
        .then(res => res.json())
        .then(projetos => {
          const resultados = projetos.filter(p =>
            p.nomeDoProjeto.toLowerCase().includes(termo.toLowerCase())
          );

          const container = document.getElementById("resultados");
          container.innerHTML = "";

          

          if (resultados.length > 0) {
            resultados.forEach(projeto => {
              const card = document.createElement("div");
              card.className = "card mb-3";
              card.innerHTML = `
                <div class="row g-0">
                  <div class="col-md-4">
                    <img src="${projeto.linkImage}" class="img-fluid rounded-start" alt="${projeto.nomeDoProjeto}">
                  </div>
                  <div class="col-md-8">
                    <div class="card-body">
                      <h5 class="card-title">${projeto.nomeDoProjeto}</h5>
                      <p class="card-text">${projeto.descricaoDoProjeto}</p>
                      ${projeto.linkGit ? `<a href="${projeto.linkGit}" target="_blank" class="btn btn-primary">Repositório GitHub</a>` : ""}
                    </div>
                  </div>
                </div>
              `;
              container.appendChild(card);
            });
          } else {
            container.innerHTML = `<p class="text-muted">Nenhum resultado encontrado para <strong>${termo}</strong>.</p>`;
          }
        })
        .catch(err => console.error("Erro ao buscar projetos:", err));
    });
  </script>
</body>
</html>
